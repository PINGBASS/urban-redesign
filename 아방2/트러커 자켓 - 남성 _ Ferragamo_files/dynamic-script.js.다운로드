var W=Object.defineProperty;var Q=(e,o,s)=>o in e?W(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s;var Z=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var J=(e,o,s)=>Q(e,typeof o!="symbol"?o+"":o,s);var w=(e,o,s)=>new Promise((r,i)=>{var C=l=>{try{u(s.next(l))}catch(p){i(p)}},m=l=>{try{u(s.throw(l))}catch(p){i(p)}},u=l=>l.done?r(l.value):Promise.resolve(l.value).then(C,m);u((s=s.apply(e,o)).next())});import{m as L,l as n,g as z,a as S,s as ee,b as te,d as ae,c as oe,e as ne,f as h,h as se,i as _,n as k,j as de,k as re,o as B,p as ce,q as y,T as I,r as X,t as N,u as v,L as M,v as U,w as R,x as ie,y as le}from"./scriptsAssets/recommendationsForCheckoutScript-BZV7YcH5.js";var ve=Z($=>{const ue=["dd2a02d1-15ad-43ff-9dfa-09a0173811fc","52156b3d-78cb-4a99-9247-62bb2126eca4","ad9cd2e6-9984-409b-83f6-c31697543d39","f6aac27d-c4ad-445d-96ee-103e3a151d01"],c=document.getElementById(L),A={script:{dispatchReady:()=>{const e=new CustomEvent("measmerize.script.ready");n.info({message:"Measmerize script is ready to use. You have passed valid data-brand-code."}),c==null||c.dispatchEvent(e)},dispatchUnavailable:e=>{const o=new CustomEvent("measmerize.script.unavailable");e?n.warn({message:"Data attribute 'brand-code' is not valid!"}):n.warn({message:"Data attribute 'brand-code' does not exist!"}),c==null||c.dispatchEvent(o)}},widget:{dispatchReady:()=>{const e=new CustomEvent("measmerize.widget.ready");n.info({message:"Widget is ready to use and will mount. Because you have passed valid data-brand-code and data-product-code."}),c==null||c.dispatchEvent(e)},dispatchUnavailable:({brandCode:e,garmentCode:o,err:s})=>{const r=new CustomEvent("measmerize.widget.unavailable");n.warn({message:`Couldn't find retailer with brandCode '${e}' and productCode '${o}'. ${s||""}`}),c==null||c.dispatchEvent(r)},dispatchRecommend:({size:e,convertedSize:o})=>{const s=new CustomEvent("measmerize.widget.recommend",{detail:{size:e,convertedSize:o}});n.info({message:`Your recommended size is: '${e}'.${o?` And your converted recommended size is: '${o}'.`:""}`}),c==null||c.dispatchEvent(s)},dispatchSelect:({size:e,convertedSize:o})=>{const s=new CustomEvent("measmerize.widget.select",{detail:{size:e,convertedSize:o}});n.info({message:`Your selected size is: '${e}'.${o?` And your converted selected size is: '${o}'.`:""}`}),c==null||c.dispatchEvent(s)},dispatchAddToCart:({size:e})=>{const o=new CustomEvent("measmerize.widget.addToCart",{detail:{size:e}});n.info({message:`'${e}' was added to cart.`}),c==null||c.dispatchEvent(o)},dispatchClearData:()=>{const e=new CustomEvent("measmerize.widget.cleardata");n.info({message:"User data has been cleared"}),c==null||c.dispatchEvent(e)},dispatchBooxiBook:()=>{const e=new CustomEvent("measmerize.widget.booxiBook");n.info({message:"Booxi booking event was fired"}),c==null||c.dispatchEvent(e)},dispatchSizesAvailability:()=>{const e=new CustomEvent("measmerize.widget.sizesAvailable");n.info({message:"measmerize.sizes.default array was set"}),c==null||c.dispatchEvent(e)},dispatchSizeChartOpen:()=>{const e=new CustomEvent("measmerize.widget.sizeChartOpen");n.info({message:"Size Chart was opened within the Measmerize widget"}),c==null||c.dispatchEvent(e)}},modal:{dispatchOpen:()=>{const e=new CustomEvent("measmerize.modal.open");n.info({message:"Modal opened"}),c==null||c.dispatchEvent(e)},dispatchClose:()=>{const e=new CustomEvent("measmerize.modal.close");n.info({message:"Modal closed"}),c==null||c.dispatchEvent(e)}}},O=r=>w($,[r],function*({isForbiddenToShareRec:e=!1,userPreferences:o,inputs:s}){const i="https://api.client.measmerize.com",m=new URL("tokens",i).toString();let u;o&&(u=z());const p=yield S(m,{headers:{"Content-Type":"application/json"},method:"PATCH",body:JSON.stringify({userPreferences:o,inputs:s,"measmerize:user:preferences":u||void 0}),credentials:e?"same-origin":"include"}),T=p["measmerize:user:inputs"],t=p["measmerize:user:preferences"];return T&&ee(T),t&&te(t),p}),ge=()=>{const e=h();return(e==null?void 0:e.modal.elementNode)||document.getElementById(ae)},me=()=>{const e=h();return(e==null?void 0:e.button.elementNode)||document.getElementById(oe)},pe=()=>{const e=h();return(e==null?void 0:e.recommendation.elementNode)||document.getElementById(ne)};function fe(){return w(this,null,function*(){const e=h();e&&(e.modal.elementNode&&e.modal.root&&(e.modal.root.unmount(),e.modal.root=null),e.button.elementNode&&e.button.root&&(e.button.root.unmount(),e.button.root=null),e.recommendation.elementNode&&e.recommendation.root&&(e.recommendation.root.unmount(),e.recommendation.root=null),e.info.product=null);const o=ge();o&&(o.innerHTML="");const s=me();s&&(s.innerHTML="");const r=pe();r&&(r.innerHTML="");const i=document.querySelectorAll(`.${se}`);for(let C=0;C<i.length;C++){const m=i[C];m.innerHTML=""}})}let K;function Y(e){return w(this,null,function*(){if(!e){n.error({message:`Measmerize script have not found by ID "${L}"`}),_({errorLevel:"critical",name:"script_no_id",errorMessage:`Data attribute 'id'="${L}" does not exist in measmerize script!`});return}const o=k(e==null?void 0:e.dataset.brandCode),s=k(e==null?void 0:e.dataset.productCode)||k(e==null?void 0:e.dataset.garmentCode),r=navigator.userAgent.toLowerCase(),i=de(r);if(o&&ue.includes(o)&&i){n.warn({message:"Bot detected, Measmerize script unavailable"}),setTimeout(()=>{A.script.dispatchUnavailable(null)},500);return}if(!o){setTimeout(()=>{A.script.dispatchUnavailable(o)},500),setTimeout(()=>{A.widget.dispatchUnavailable({brandCode:o,garmentCode:s})},500),_({errorLevel:"error",name:"script_no_brand_code",errorMessage:"Couldn't find brandCode in measmerize script!",brandCode:o,productCode:s});return}try{yield re({brandCode:o})}catch(m){fe(),A.script.dispatchUnavailable(o),n.warn({message:"Don't forget to reload page after changing to valid brandCode"});const u=B(m);_({errorLevel:"warning",name:"script_invalid_brand_code",errorMessage:"Data attribute 'brand-code' is not available in admin panel!",brandCode:o,productCode:s,errorObject:u});return}if(window.location.port!="5173")try{const m=yield fetch(`https://client.measmerize.com/api/dynamic-assets/${o}`,{method:"GET"}),u=yield m.json();if(!m.ok)throw new Error(`Error with status code ${m.status}, body: ${JSON.stringify(u)}`);const l=u.brandName;e.dataset.brandName=l;const p=u.entrypoints,T=(p==null?void 0:p.css)||[],t=(p==null?void 0:p.js)||[],a=e==null?void 0:e.parentNode,d=document.querySelectorAll('link[data-injected-css="injected-main-css"]'),b=document.querySelectorAll('script[data-injected-js="injected--main-js"]');try{for(let f=0;f<b.length;f++){const g=b[f];if(n.debug({message:"script.dataset.injectedBrandName - ",object:g.dataset.injectedBrandName}),g.dataset.injectedBrandName!==l)throw new Error("existed")}for(let f=0;f<d.length;f++)if(d[f].dataset.injectedBrandName!==l)throw new Error("existed")}catch(f){const g="This action did not lead to changes. You are trying to change a brandCode that is not supported by retailer. If you still want to change brandCode, you need to replace the data-attribute in the measmerize script and reload the page.";n.error({message:g}),e.dataset.brandCode=K;const j=B(f);_({errorLevel:"warning",name:"script_invalid_same_dataset",errorMessage:g,brandCode:o,productCode:s,errorObject:j});return}K=o;const E=document.getElementById(ce);d.length===0&&T.forEach(f=>{const g=document.createElement("link");g.id=f.name,g.dataset.injectedBrandName=l,g.dataset.injectedCss="injected--main-css",g.href=f.link,g.rel="stylesheet",a&&a.insertBefore(g,E.nextSibling)}),b.length===0&&t.forEach(f=>{const g=document.createElement("script");g.id=f.name,g.dataset.injectedBrandName=l,g.dataset.injectedJs="injected-main-js",g.src=f.link,g.type="module",a&&a.insertBefore(g,E.nextSibling)});const G="3.31.4";G&&n.debug({message:`Current version of measmerize widget script --- '${G}'.`}),A.script.dispatchReady()}catch(m){n.error({message:`Something wrong, when tried to inject measmerize script. ${m}`});const u=B(m);_({errorLevel:"critical",name:"script_react_injection_failed",errorMessage:"Something wrong, when tried to inject measmerize script.",brandCode:o,productCode:s,errorObject:u});return}})}function be(e){const o=new MutationObserver(function(s){s.forEach(function(r){return w(this,null,function*(){r.type==="attributes"&&r.attributeName==="data-brand-code"&&Y(e)})})});e&&o.observe(e,{attributes:!0})}const Ce=({brandCode:e,measmerizeScript:o})=>{var m;let s=null;const r="G-XKHXS7XJLJ",i=(m=h())==null?void 0:m.script.brandName;if(i==="ferragamo")return;if(o&&(e=k(o==null?void 0:o.dataset.brandCode),s=k((o==null?void 0:o.dataset.productCode)||(o==null?void 0:o.dataset.garmentCode))),!y())return console.error("Measmerize Tracking doesn't work, because LocalStorage is not available!"),!1;if(localStorage.getItem(I)==="0"||i==="ferragamo"||e==="ac58d917-65a4-4c9c-bd4a-351e80b4efdb")return!1;n.info({message:"GA Analytics initialized"});try{let u=function(){window.dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];const l=document.createElement("script");l.async=!0,l.id=X,l.src=`https://www.googletagmanager.com/gtag/js?id=${r}`,document.head.append(l),window.measmerizeGtag=u,window.measmerizeGtag("js",new Date),window.measmerizeGtag("set","user_properties",{brand_code:e}),window.measmerizeGtag("config",r,{groups:"measmerizeGroup"}),window[`ga-disable-${r}`]=!1}catch(u){n.warn({message:`GTAG ERROR, ${u}`});const l=B(u);_({errorLevel:"error",name:"react_GA_injection",errorMessage:"Error while injecting GA",brandCode:e,productCode:s,errorObject:l})}},q={addGAEvent:({garmentType:e,eventName:o})=>{if(!y()){n.log({message:"Google Analytics doesn't work, because LocalStorage is not available!"});return}const s=h(),r=localStorage.getItem(I),i=!r||r!=="0",C={garment_type:e==="shoes"?"shoe":"apparel",send_to:"measmerizeGroup"};!i&&s?s.developSettings.eventsArray.push({garmentType:e,eventName:o}):window.measmerizeGtag&&(window.measmerizeGtag("event",o,C),n.debug({message:`Tracking - Analytics: ${o}`}))},sendPendingEvents:()=>{const e=h(),o=e==null?void 0:e.developSettings.eventsArray;o&&o.forEach(s=>{const r={garment_type:s.garmentType==="shoes"?"shoe":"apparel",send_to:"measmerizeGroup"};try{window.measmerizeGtag&&(window.measmerizeGtag("event",s.eventName,r),n.debug({message:`Tracking - Analytics: ${s.eventName}`}))}catch(i){n.warn({message:`GTAG ERROR, ${i.statusText}`})}}),e&&(e.developSettings.eventsArray=[])}},P=r=>w($,[r],function*({eventName:e,page:o,properties:s}){var p;const i=h(),C=((p=i==null?void 0:i.info.product)==null?void 0:p.type)||null,m=(i==null?void 0:i.script.brandCode)||null,u=(i==null?void 0:i.script.langCode)||null,l=(i==null?void 0:i.script.countryCode)||null;N({eventName:e,brandCode:m,page:o,properties:s,langCode:u,countryCode:l}),q.addGAEvent({eventName:e,garmentType:C})});function ye(e){if(!e)return;const o=e.dataset.objectName||"measmerize",s="G-XKHXS7XJLJ",r={get brandName(){return e.dataset.brandName},set brandName(t){const a=typeof t;if(a!=="string"){v({object:"script.brandName",expectedType:"string",typeofValue:a});return}e.dataset.brandName=t,n.log({message:`'data-brand-name' attribute changed to '${t}'`})},get langCode(){var a;return(a=e.dataset.langCode)==null?void 0:a.toLowerCase()},set langCode(t){const a=typeof t;if(a!=="string"){v({object:"script.langCode",expectedType:"string",typeofValue:a});return}e.dataset.langCode=t==null?void 0:t.toLowerCase(),n.log({message:`'data-lang-code' attribute changed to '${t}'`})},get countryCode(){var a;return(a=e.dataset.countryCode)==null?void 0:a.toLowerCase()},set countryCode(t){const a=typeof t;if(a!=="string"){v({object:"script.countryCode",expectedType:"string",typeofValue:a});return}e.dataset.countryCode=t==null?void 0:t.toLowerCase(),n.log({message:`'data-country-code' attribute changed to '${t}'`})},get productCode(){const t=e.dataset.productCode,a=e.dataset.garmentCode;return t||a},set productCode(t){const a=typeof t;if(a!=="string"){v({object:"script.productCode",expectedType:"string",typeofValue:a});return}const d=k(t);d?(e.dataset.productCode=d,n.log({message:`'data-product-code' attribute changed to '${d}'`})):n.error({message:"Please pass valid 'productCode'"})},get garmentCode(){return r.productCode},set garmentCode(t){const a=typeof t;if(a!=="string"){v({object:"script.garmentCode",expectedType:"string",typeofValue:a});return}const d=k(t);d?(e.dataset.garmentCode=d,n.log({message:`'data-garment-code' attribute changed to '${d}'`}),e.dataset.productCode&&n.warn({message:"Changing the attribute 'data-garment-code' had no effect, because the measmerize-script already has a 'data-product-code' attribute, which is preferable. Change it instead."})):n.error({message:"Please pass valid 'garmentCode'"})},get brandCode(){return e.dataset.brandCode},set brandCode(t){const a=typeof t;if(a!=="string"){v({object:"script.brandCode",expectedType:"string",typeofValue:a});return}const d=k(t);d?(e.dataset.brandCode=d,n.log({message:`'data-brand-code' attribute changed to '${d}'`})):n.error({message:"Please pass valid 'brandCode'"})},get productTitle(){return e.dataset.productTitle},set productTitle(t){const a=typeof t;if(a!=="string"){v({object:"script.productTitle",expectedType:"string",typeofValue:a});return}const d=k(t);d?(e.dataset.productTitle=d,n.log({message:`'data-product-title' attribute changed to '${d}'`})):n.error({message:"Please pass valid 'productTitle'"})},get productImage(){return e.dataset.productImage},set productImage(t){const a=typeof t;if(a!=="string"){v({object:"script.productImage",expectedType:"string",typeofValue:a});return}t?(e.dataset.productImage=t,n.log({message:`'data-product-image' attribute changed to '${t}'`})):n.error({message:"Please pass valid 'productImage'"})},get productPrice(){return e.dataset.productPrice},set productPrice(t){const a=typeof t;if(a==="number"||a==="string"){const d=t;e.dataset.productPrice=d.toString(),n.log({message:`'data-product-price' attribute changed to '${d}'`})}else v({object:"script.productPrice",expectedType:"string",typeofValue:a})},get productCurrency(){return e.dataset.productCurrency},set productCurrency(t){const a=typeof t;if(a!=="string"){v({object:"script.productCurrency",expectedType:"string",typeofValue:a});return}const d=k(t);d?(e.dataset.productCurrency=d,n.log({message:`'data-product-currency' attribute changed to '${d}'`})):n.error({message:"Please pass valid 'productCurrency'"})},get logger(){if(!y())return!1;const t=localStorage.getItem(M)==="1";return n.log({message:`logger is '${t?"enabled":"disabled"}'`}),t},set logger(t){if(!y()){n.log({message:"Logger can not be changed because local storage doesn't work"});return}const a=typeof t;if(a!=="boolean"){v({object:"script.logger",expectedType:"boolean",typeofValue:a});return}t?(localStorage.setItem(M,"1"),n.log({message:"logger is enabled"})):(localStorage.setItem(M,"0"),n.log({message:"logger is disabled"}))}},i={send:{addToBasket:()=>{const t=h();P({eventName:t!=null&&t.isRecoReceived?"add_to_cart_button_with_recommendation_click":"add_to_cart_button_without_recommendation_click",page:"product_detail_page"}),t!=null&&t.developSettings.isSizeChartButtonClicked&&P({eventName:"add_to_cart_button_after_size_chart_clicked",page:"product_detail_page"})},openSizeGuide:()=>{P({eventName:"size_chart_button_click",page:"product_detail_page"})}},get analyticsStatus(){if(!y())return!0;const t=localStorage.getItem(I),a=!t||t!=="0";return a?n.log({message:"Tracking - Analytics enabled"}):n.log({message:"Tracking - Analytics disabled"}),a},disableAnalytics:()=>{if(!y()){n.log({message:"Tracking - Analytics can not be changed because local storage doesn't work"});return}const t=r.brandCode||"",a=r.garmentCode,d=r.langCode||null,b=r.countryCode||null;if(N({eventName:"deactivate_google_analytics_tracking",brandCode:t,garmentCode:a,langCode:d,countryCode:b,page:"product_detail_page"}),(t==="c46b226f-2753-483a-84da-a7890e48522d"||t==="3bb7f917-c82b-48bd-90db-186d0e536bff")&&(b==="kr"||b==="jp")){localStorage.setItem(I,"1");return}window[`ga-disable-${s}`]=!0,localStorage.setItem(I,"0"),n.log({message:"Tracking - Analytics disabled"})},enableAnalytics:()=>{var j,F,V;if(!y()){n.log({message:"Tracking - Analytics can not be changed because local storage doesn't work"});return}localStorage.setItem(I,"1");const t=document.getElementById(X),a=h(),d=(j=a==null?void 0:a.info.product)==null?void 0:j.isGaActive,b=e.dataset.brandName;let E=e.dataset.brandCode;if(b==="ferragamo"||E==="ac58d917-65a4-4c9c-bd4a-351e80b4efdb"||E==="d0c4ae65-e013-41a3-a68b-4e2612ac6475")return;if(!t&&(d==null||d)){Ce({measmerizeScript:e});const H=(F=a==null?void 0:a.info.product)==null?void 0:F.gaID,x=(V=a==null?void 0:a.info.product)==null?void 0:V.isGaIDActive;H&&(x==null||x)&&window.measmerizeGtag&&window.measmerizeGtag("config",H,{groups:"measmerizeGroup"})}E=r.brandCode||"";const G=r.garmentCode,f=r.langCode||null,g=r.countryCode||null;N({eventName:"activate_google_analytics_tracking",brandCode:E,garmentCode:G,langCode:f,countryCode:g,page:"product_detail_page"}),window[`ga-disable-${s}`]=!1,q.sendPendingEvents(),n.log({message:"Tracking - Analytics enabled"})},get checkoutStatus(){if(!y())return!0;const t=localStorage.getItem(U),a=!t||t!=="0";return a?n.log({message:"Tracking - Checkout enabled"}):n.log({message:"Tracking - Checkout disabled"}),a},disableCheckout:()=>{if(!y()){n.log({message:"Tracking - Checkout can not be changed because local storage doesn't work"});return}localStorage.setItem(U,"0"),n.log({message:"Tracking - Checkout disabled"})},enableCheckout:()=>{if(!y()){n.log({message:"Tracking - Checkout can not be changed because local storage doesn't work"});return}localStorage.setItem(U,"1"),n.log({message:"Tracking - Checkout enabled"})},get customStatus(){if(!y())return!0;const t=localStorage.getItem(R),a=!t||t!=="0";return a?n.log({message:"Tracking - Custom enabled"}):n.log({message:"Tracking - Custom disabled"}),a},disableCustom:()=>w(this,null,function*(){if(!y()){n.log({message:"Tracking - Custom can not be changed because local storage doesn't work"});return}const t=r.brandCode||"",a=r.garmentCode,d=r.langCode||null,b=r.countryCode||null;if(N({eventName:"deactivate_custom_tracking",brandCode:t,garmentCode:a,langCode:d,countryCode:b,page:"product_detail_page"}),(t==="c46b226f-2753-483a-84da-a7890e48522d"||t==="3bb7f917-c82b-48bd-90db-186d0e536bff")&&(b==="kr"||b==="jp")){localStorage.setItem(R,"1");return}localStorage.setItem(R,"0"),n.log({message:"Tracking - Custom disabled"})}),enableCustom:()=>{if(!y()){n.log({message:"Tracking - Custom can not be changed because local storage doesn't work"});return}const t=r.brandCode||"",a=r.garmentCode,d=r.langCode||null,b=r.countryCode||null;localStorage.setItem(R,"1"),n.log({message:"Tracking - Custom enabled"}),N({eventName:"activate_custom_tracking",brandCode:t,garmentCode:a,langCode:d,countryCode:b,page:"product_detail_page"}),ie()}},C={getUserRecommendations:()=>le().map(d=>({productCode:d.productCode,recommendedSize:d.recommendedSize}))},m={disableFunctional:()=>w(this,null,function*(){const t=h(),a={retailerFunctional:!1};t!=null&&t.developSettings&&(t.developSettings.retailerFunctionalCookies=!1),yield O({userPreferences:a}),n.log({message:"Cookies - Functional disabled"})}),enableFunctional:()=>w(this,null,function*(){const t=h(),a={retailerFunctional:!0};t!=null&&t.developSettings&&(t.developSettings.retailerFunctionalCookies=!0),yield O({userPreferences:a}),n.log({message:"Cookies - Functional enabled"})})};class u{constructor(){J(this,"_default");this._default=void 0}get default(){return this._default}set default(a){if(a&&!Array.isArray(a)){n.warn({message:"Pass a valid array for measmerize.sizes.default"});return}this._default=a,n.log({message:"Sizes availability is set with measmerize.sizes.default "}),A.widget.dispatchSizesAvailability()}}const l=new u,p={addToCart:void 0},T=null;window[o]={script:r,tracking:i,cookies:m,info:{},modal:{},button:{},developSettings:{isSizeChartButtonClicked:!1,eventsArray:[],customEventsArray:[],retailerFunctionalCookies:null},booxi:C,recommendation:{},isRecoReceived:T,sizes:l,operations:p}}const D=document.getElementById(L);function he(){return w(this,null,function*(){ye(D),yield Y(D),be(D)})}he()});export default ve();
